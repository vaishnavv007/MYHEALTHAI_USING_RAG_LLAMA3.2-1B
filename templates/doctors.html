{% extends 'base.html' %}
{% block content %}
<div class="container my-4">
  <h2 class="mb-4">Doctor Directory</h2>

  <!-- Filter Form -->
  <form method="get" class="filters d-flex flex-wrap align-items-center mb-4 gap-3">
    <select name="state" class="form-select" style="min-width: 150px;">
      <option value="">Select State</option>
      {% for s in states %}
        <option value="{{ s }}" {% if request.args.get('state') == s %}selected{% endif %}>{{ s }}</option>
      {% endfor %}
    </select>

    <select name="district" class="form-select" style="min-width: 150px;">
      <option value="">Select District</option>
      {% for d in districts %}
        <option value="{{ d }}" {% if request.args.get('district') == d %}selected{% endif %}>{{ d }}</option>
      {% endfor %}
    </select>

    <select name="category" class="form-select" style="min-width: 150px;">
      <option value="">Select Category</option>
      {% for c in categories %}
        <option value="{{ c }}" {% if request.args.get('category') == c %}selected{% endif %}>{{ c }}</option>
      {% endfor %}
    </select>

    <button type="submit" class="btn btn-primary px-4">Filter</button>
  </form>

  <!-- Doctor Cards (scrollable container showing max 3 cards at once) -->
  <div class="doctor-list border rounded shadow-sm p-3" style="max-height: 600px; overflow-y: auto;">
    {% for doc in doctors %}
    <div class="card mb-3 shadow-sm">
      <div class="card-body">
        <h4 class="card-title">{{ doc.name }}</h4>
        <p class="mb-1"><strong>Category:</strong> {{ doc.category }}</p>
        <p class="mb-1"><strong>Rating:</strong> {{ doc.rating }}</p>
        <p class="mb-3"><strong>Location:</strong> {{ doc.location }}</p>

        <button onclick="toggleDetails('{{ doc._id }}')" class="btn btn-outline-info btn-sm">
          Show Details
        </button>

        <div id="details-{{ doc._id }}" class="mt-3" style="display:none; border-top: 1px solid #eee; padding-top: 10px;">
          {% if doc.email %}<p><strong>Email:</strong> {{ doc.email }}</p>{% endif %}
          {% if doc.phone %}<p><strong>Phone:</strong> {{ doc.phone }}</p>{% endif %}
          {% if doc.experience %}<p><strong>Experience:</strong> {{ doc.experience }}</p>{% endif %}
          {% if doc.education %}<p><strong>Education:</strong> {{ doc.education }}</p>{% endif %}
          {% if doc.about %}<p><strong>About:</strong> {{ doc.about }}</p>{% endif %}
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

<script>
function toggleDetails(id) {
  const el = document.getElementById('details-' + id);
  if (!el) return;
  el.style.display = (el.style.display === 'none' || el.style.display === '') ? 'block' : 'none';
}
</script>

<style>
.filters select, .filters button {
  min-width: 150px;
}

.card {
  transition: box-shadow 0.3s ease;
}

.card:hover {
  box-shadow: 0 0 12px rgba(0, 123, 255, 0.3);
}

.doctor-list::-webkit-scrollbar {
  width: 8px;
}

.doctor-list::-webkit-scrollbar-thumb {
  background-color: rgba(0, 123, 255, 0.5);
  border-radius: 4px;
}

.doctor-list::-webkit-scrollbar-track {
  background: #f1f1f1;
}
</style>
{% endblock %}
